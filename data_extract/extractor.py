import pandas as pd

# --- File Paths ---
input_file = "inscriptions_vol1.csv"
output_file = "filtered_inscriptions.csv"

# --- List of inscription numbers to match ---
numbers_to_match = [
    8, 6, 35, 55, 45, 63, 69, 74, 104, 123, 127, 129, 131, 128, 132, 133, 137,
    143, 147, 148, 150, 153, 151, 152, 155, 160, 162, 163, 167, 168, 169, 170,
    174, 178, 179, 180, 181, 187, 201, 202, 204, 206, 210, 212, 213, 215, 216,
    217, 218, 221, 225, 226, 227, 238, 239, 241, 242, 245, 246, 249, 250, 252,
    254, 255, 256, 261, 265, 267, 279, 280, 283, 289, 290, 291, 293, 301, 304,
    305, 308, 310, 311, 312, 314, 319, 324, 325, 326, 327, 328, 329, 330, 331,
    335, 336, 337, 338, 342, 343, 352, 357, 365, 369, 345, 353, 380, 387, 389,
    390, 391, 392, 395, 397, 399, 400, 401, 403, 404, 405, 407, 408, 410, 411,
    412, 414, 418, 422, 423, 424, 426, 430, 442, 443, 444, 445, 448, 449, 450,
    451, 453, 454, 455, 461, 464, 465, 469, 473, 475, 477, 478, 479, 495, 496,
    497, 498, 499, 500, 501, 503, 505, 506, 507, 508, 509, 510, 511, 512, 514,
    516, 517, 518, 526, 535, 536, 537, 539, 544, 545, 546, 570, 571, 578, 580,
    581, 582, 583, 584, 585, 586, 587, 588, 589, 591, 593, 594, 595, 604, 611,
    616, 623, 626, 629, 638, 642, 656, 657, 658, 659, 668, 670, 673, 675, 680,
    681, 682, 689, 690, 692, 693, 695, 700, 701, 710, 711, 712, 714, 715, 716,
    717, 718, 719, 722, 723, 726, 728, 729, 730, 731, 732, 735, 741, 756, 765,
    772, 783, 800, 801, 804, 809, 814, 816, 817, 824, 831, 844, 845, 847, 848,
    850, 851, 852, 859, 861, 862, 863, 864, 867, 868, 869, 870, 872, 875, 876,
    877, 878, 880, 885, 906, 914, 915, 918, 922, 924, 926, 927, 928, 929, 930,
    931, 958, 980, 989, 991, 997, 1008, 1017, 1027, 1028, 1029, 1030, 1031, 1035,
    1037, 1038, 1039, 1041, 1060, 1065, 1066, 1067, 1068, 1069, 1070, 1071, 1072,
    1075, 1078, 1079, 1081, 1084, 1085, 1086, 1087, 1088, 1090, 1093, 1094, 1097,
    1103, 1155, 1171, 1172, 1188, 1191, 1203, 1221, 1231, 1232
]

# --- Read the CSV (Sinhala-safe) ---
df = pd.read_csv(input_file)

# --- Convert number column to int, just in case it's string ---
df["සෙල්ලිපි අංකය"] = pd.to_numeric(df["සෙල්ලිපි අංකය"], errors='coerce')

# --- Filter based on matching numbers ---
filtered_df = df[df["සෙල්ලිපි අංකය"].isin(numbers_to_match)]

# --- Save to new CSV with Sinhala-safe encoding ---
filtered_df.to_csv(output_file, index=False, encoding='utf-8-sig')

print(f"✅ Filtered Sinhala CSV saved to: {output_file}")
